# Bus Signal Distribution Analyzer

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
- [–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã](#–æ–±–∑–æ—Ä-—Å–∏—Å—Ç–µ–º—ã)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å–∏—Å—Ç–µ–º—ã)
- [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è —Ä–∞–±–æ—Ç—ã](#—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è-—Ä–∞–±–æ—Ç—ã)
- [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—é](#—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è-–∫-–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—é)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–∑–∞–ø—É—Å–∫)
- [–§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö ESP32](#—Ñ–æ—Ä–º–∞—Ç-–¥–∞–Ω–Ω—ã—Ö-esp32)
- [–ê–ª–≥–æ—Ä–∏—Ç–º –∞–Ω–∞–ª–∏–∑–∞](#–∞–ª–≥–æ—Ä–∏—Ç–º-–∞–Ω–∞–ª–∏–∑–∞)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

## üöå –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

**Bus Signal Distribution Analyzer** - —ç—Ç–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è WiFi —Å–∏–≥–Ω–∞–ª–æ–≤ –≤ –∞–≤—Ç–æ–±—É—Å–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è RSSI (Received Signal Strength Indicator). –°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø–æ –∑–æ–Ω–∞–º –∞–≤—Ç–æ–±—É—Å–∞ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É.

### üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- üì° **–†–µ–∞–ª—å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - —Å–±–æ—Ä RSSI –¥–∞–Ω–Ω—ã—Ö —Å ESP32 —á–µ—Ä–µ–∑ COM-–ø–æ—Ä—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- üìä **–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑** - –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ –ø–æ –∑–æ–Ω–∞–º –∞–≤—Ç–æ–±—É—Å–∞
- üìà **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –≥—Ä–∞—Ñ–∏–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- üíæ **–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö** - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ CSV —Ñ–æ—Ä–º–∞—Ç–µ
- üîÑ **–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ü–∏–∫–ª—ã —Å–±–æ—Ä–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    Serial/USB    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   ESP32 Module  ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ   Python Analyzer‚îÇ
‚îÇ                 ‚îÇ                  ‚îÇ                  ‚îÇ
‚îÇ  - WiFi Scanner ‚îÇ                  ‚îÇ  - Data Processor‚îÇ
‚îÇ  - RSSI Collector‚îÇ                 ‚îÇ  - Visualization ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                  ‚îÇ  - CSV Export    ‚îÇ
                                     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                              ‚îÇ
                                     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                     ‚îÇ   Results       ‚îÇ
                                     ‚îÇ   Directory     ‚îÇ
                                     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è —Ä–∞–±–æ—Ç—ã

### 1. üì° –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö (ESP32)
ESP32 —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ WiFi —Å–∫–∞–Ω–µ—Ä:
- –°–∫–∞–Ω–∏—Ä—É–µ—Ç –æ–∫—Ä—É–∂–∞—é—â–∏–µ WiFi —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- –ò–∑–º–µ—Ä—è–µ—Ç RSSI (—Å–∏–ª—É —Å–∏–≥–Ω–∞–ª–∞) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ: `timestamp,rssi` –∏–ª–∏ `rssi`
- RSSI –∑–Ω–∞—á–µ–Ω–∏—è –≤–∞—Ä—å–∏—Ä—É—é—Ç—Å—è –æ—Ç -30 dBm (–±–ª–∏–∑–∫–æ) –¥–æ -100 dBm (–¥–∞–ª–µ–∫–æ)

### 2. üéØ –ê–ª–≥–æ—Ä–∏—Ç–º –∞–Ω–∞–ª–∏–∑–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

#### –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–æ–Ω –∞–≤—Ç–æ–±—É—Å–∞:
```python
location_thresholds = {
    'back': -50,    # –ó–∞–¥–Ω—è—è —á–∞—Å—Ç—å - —Å–∏–ª—å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã (–±–ª–∏–∑–∫–æ –∫ –ø—Ä–∏–µ–º–Ω–∏–∫—É)
    'middle': -65,  # –°—Ä–µ–¥–Ω—è—è —á–∞—Å—Ç—å - —Å—Ä–µ–¥–Ω–∏–µ —Å–∏–≥–Ω–∞–ª—ã  
    'front': -85    # –ü–µ—Ä–µ–¥–Ω—è—è —á–∞—Å—Ç—å - —Å–ª–∞–±—ã–µ —Å–∏–≥–Ω–∞–ª—ã (–¥–∞–ª–µ–∫–æ –æ—Ç –ø—Ä–∏–µ–º–Ω–∏–∫–∞)
}
```

#### –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è:
```python
def get_location(rssi):
    if rssi > -50:    return 2, 'Back'    # –ë–ª–∏–∑–∫–æ –∫ –ø—Ä–∏–µ–º–Ω–∏–∫—É (–∑–∞–¥–Ω—è—è —á–∞—Å—Ç—å)
    elif rssi > -65:  return 1, 'Middle'  # –°—Ä–µ–¥–Ω–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ
    elif rssi > -85:  return 0, 'Front'   # –î–∞–ª–µ–∫–æ –æ—Ç –ø—Ä–∏–µ–º–Ω–∏–∫–∞ (–ø–µ—Ä–µ–¥–Ω—è—è —á–∞—Å—Ç—å)
    else:             return -1, 'Noise'  # –°–ª–∏—à–∫–æ–º —Å–ª–∞–±—ã–π —Å–∏–≥–Ω–∞–ª
```

### 3. üß† –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

#### –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤:
```python
def group_similar_devices(df, rssi_threshold=5, time_window_seconds=2, max_packets=5):
    # –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –ø–æ—Ö–æ–∂–∏–µ RSSI —Å–∏–≥–Ω–∞–ª—ã –≤ –≤—Ä–µ–º–µ–Ω–Ω–æ–º –æ–∫–Ω–µ
    # –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
```

#### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –æ—Å—Ç–∞–Ω–æ–≤–æ–∫:
```python
def filter_short_stops(self, min_stop_duration=1):
    # –§–∏–ª—å—Ç—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å –∫–æ—Ä–æ—Ç–∫–∏—Ö –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ (< 1 –º–∏–Ω—É—Ç—ã)
    # –û—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
```

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- Python 3.8 –∏–ª–∏ –Ω–æ–≤–µ–µ
- pip (–º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤ Python)
- –î–æ—Å—Ç—É–ø –∫ –ø–æ—Ä—Ç—É USB –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è ESP32 (–æ–±—ã—á–Ω–æ `/dev/ttyUSB0` –Ω–∞ Linux)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
```bash
pip install pandas numpy matplotlib pyserial
```

### –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã:
```bash
python bus_analyzer.py
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python:
```txt
pandas>=1.5.0      # –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞
numpy>=1.21.0      # –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
matplotlib>=3.5.0  # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
pyserial>=3.5      # –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —Å ESP32
```

## üì° –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö ESP32

### –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ—Ä–º–∞—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
```
timestamp,rssi
```
**–ü—Ä–∏–º–µ—Ä:**
```
123456789,-65
123456790,-72
123456791,-58
```

### –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:
```
rssi
```
**–ü—Ä–∏–º–µ—Ä:**
```
-65
-72
-58
```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¥–∞–Ω–Ω—ã–º:
- **Timestamp**: –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã —Å –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã ESP32 (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **RSSI**: —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ –æ—Ç -30 –¥–æ -100
- **–†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å**: –∑–∞–ø—è—Ç–∞—è –¥–ª—è timestamp —Ñ–æ—Ä–º–∞—Ç–∞
- **–ö–æ–¥–∏—Ä–æ–≤–∫–∞**: UTF-8
- **–ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Å—Ç—Ä–æ–∫–∏**: —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è ESP32, –æ—à–∏–±–∫–∏ WiFi

## üßÆ –ê–ª–≥–æ—Ä–∏—Ç–º –∞–Ω–∞–ª–∏–∑–∞

### 1. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
```python
def filter_short_stops(df, min_stop_duration=1):
    # –§–∏–ª—å—Ç—Ä—É–µ—Ç –∫–æ—Ä–æ—Ç–∫–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (< 1 –º–∏–Ω—É—Ç—ã)
    # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å –¥–≤–∏–∂—É—â–µ–≥–æ—Å—è –∞–≤—Ç–æ–±—É—Å–∞
    # –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º
```

### 2. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤
- **Back** (–ó–∞–¥–Ω—è—è): RSSI > -50 dBm
- **Middle** (–°—Ä–µ–¥–Ω—è—è): -65 ‚â§ RSSI < -50 dBm  
- **Front** (–ü–µ—Ä–µ–¥–Ω—è—è): -85 ‚â§ RSSI < -65 dBm
- **Noise** (–®—É–º): RSSI < -85 dBm

### 3. –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
```python
def generate_summary(df, cycle_count):
    # –†–∞—Å—á–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ –∑–æ–Ω–∞–º
    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–µ–æ–±–ª–∞–¥–∞—é—â–µ–π –∑–æ–Ω—ã
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ—Ç—á–µ—Ç–∞
    # –ê–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö
```

### 4. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- **–ì—Ä–∞—Ñ–∏–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è**: RSSI —Å–∏–≥–Ω–∞–ª—ã —Å –ø–æ—Ä–æ–≥–∞–º–∏ –∑–æ–Ω
- **–°—Ö–µ–º–∞ –∞–≤—Ç–æ–±—É—Å–∞**: –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏ –∑–æ–Ω
- **–ì—Ä–∞—Ñ–∏–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ –º–∏–Ω—É—Ç—É**: –¥–∏–Ω–∞–º–∏–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

## üìä –ö–ª–∞—Å—Å BusDistributionAnalyzer

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:
- `__init__(com_port, baudrate, output_dir)` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–∏—Å—Ç–µ–º—ã
- `start_data_collection(collection_minutes)` - –Ω–∞—á–∞–ª–æ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å ESP32
- `run_continuous_analysis(collection_minutes, cycles)` - –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã
- `calculate_distribution(df)` - –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ –ø–æ –∑–æ–Ω–∞–º
- `plot_distribution_analysis(df, cycle_count)` - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã:
- `connect_serial()` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ ESP32
- `filter_short_stops()` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- `group_similar_devices()` - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- `generate_summary()` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞
- `save_data_to_csv()` - —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ CSV

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```python
# –ü–æ—Ä—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è ESP32
com_port = '/dev/ttyUSB0'

# –°–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö
baudrate = 115200

# –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
output_dir = 'results'

# –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö (–º–∏–Ω—É—Ç—ã)
collection_minutes = 2

# –ü–æ—Ä–æ–≥–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ RSSI
location_thresholds = {
    'back': -50,
    'middle': -65, 
    'front': -85
}
```

## üöÄ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –¢–∏–ø–∏—á–Ω—ã–π —Ä–∞–±–æ—á–∏–π —Ü–∏–∫–ª:
```
–¶–∏–∫–ª –∞–Ω–∞–ª–∏–∑–∞ #1
--------------------------------------------------
–ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ /dev/ttyUSB0
–ù–∞—á–∞—Ç —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –Ω–∞ 2 –º–∏–Ω—É—Ç...
–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω. –°–æ–±—Ä–∞–Ω–æ 847 –∏–∑–º–µ—Ä–µ–Ω–∏–π
–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ (< 1 –º–∏–Ω)...
–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ç–∞–±–ª–∏—Ü—É: results/collected_data_cycle_1.csv
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞: results/summary_stats_cycle_1.csv

============================================================
–ê–ù–ê–õ–ò–ó –†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–Ø –°–ò–ì–ù–ê–õ–û–í –í –ê–í–¢–û–ë–£–°–ï
============================================================
–ü–µ—Ä–∏–æ–¥ –∞–Ω–∞–ª–∏–∑–∞: 2.0 –º–∏–Ω—É—Ç
–í—Å–µ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏–π RSSI: 723
–°—Ä–µ–¥–Ω–∏–π RSSI: -68.5 dBm
–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ—Ä–æ–≥–∏: Front=-85, Middle=-65, Back=-50

--- –†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–ï –°–ò–ì–ù–ê–õ–û–í –ü–û –ó–û–ù–ê–ú ---
–í—Å–µ–≥–æ –≤–∞–ª–∏–¥–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤: 723
–®—É–º/–ø–æ—Ç–µ—Ä–∏: 124
Front :   110 –∏–∑–º–µ—Ä–µ–Ω–∏–π ( 15.2%)
Middle:   331 –∏–∑–º–µ—Ä–µ–Ω–∏–π ( 45.8%)
Back  :   282 –∏–∑–º–µ—Ä–µ–Ω–∏–π ( 39.0%)

–ü–†–ï–û–ë–õ–ê–î–ê–Æ–©–ò–ô –°–ò–ì–ù–ê–õ: –°–ú–ï–®–ê–ù–ù–û–ï

–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤ –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º...
–í—Å–µ–≥–æ –ø–∞–∫–µ—Ç–æ–≤: 723
–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤: 156
–ì—Ä–∞—Ñ–∏–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω: results/distribution_analysis_cycle_1.png
–ì—Ä–∞—Ñ–∏–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω: results/devices_per_minute_cycle_1.png
```

### –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã:
- `collected_data_cycle_N.csv` - —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏–π
- `summary_stats_cycle_N.csv` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ü–∏–∫–ª—É
- `distribution_analysis_cycle_N.png` - –≥—Ä–∞—Ñ–∏–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
- `devices_per_minute_cycle_N.png` - –¥–∏–Ω–∞–º–∏–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä–æ–≥–æ–≤ RSSI:
```python
# –í –∫–ª–∞—Å—Å–µ BusDistributionAnalyzer
self.location_thresholds = {
    'back': -50,    # –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥ –≤–∞—à –∞–≤—Ç–æ–±—É—Å
    'middle': -65,  # –∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ ESP32
    'front': -85
}
```

### –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤:
1. **–ú–∞–ª–µ–Ω—å–∫–∏–π –∞–≤—Ç–æ–±—É—Å**: —É–º–µ–Ω—å—à–∏—Ç–µ –ø–æ—Ä–æ–≥–∏ –Ω–∞ 5-10 dBm
2. **–ë–æ–ª—å—à–æ–π –∞–≤—Ç–æ–±—É—Å**: —É–≤–µ–ª–∏—á—å—Ç–µ –ø–æ—Ä–æ–≥–∏ –Ω–∞ 5-10 dBm  
3. **–†–∞–∑–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ ESP32**: —Ç—Ä–µ–±—É–µ—Ç—Å—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞
4. **–ì–æ—Ä–æ–¥—Å–∫–∞—è —Å—Ä–µ–¥–∞**: –º–æ–≥—É—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–µ –ø–æ—Ä–æ–≥–∏ –∏–∑-–∑–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ—Ä–µ–Ω—Ü–∏–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:
```python
# –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö (–º–∏–Ω—É—Ç—ã)
collection_minutes = 2

# –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (–º–∏–Ω—É—Ç—ã)  
min_stop_duration = 1

# –û–∫–Ω–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (—Å–µ–∫—É–Ω–¥—ã)
time_window_seconds = 2

# –ü–æ—Ä–æ–≥ RSSI –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ (dBm)
rssi_threshold = 5
```

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

#### 1. –ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ ESP32:
```
–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ /dev/ttyUSB0: [Errno 2] No such file or directory
```
**–†–µ—à–µ–Ω–∏–µ**: 
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ ESP32
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø–æ—Ä—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π (`/dev/ttyUSB0` –Ω–∞ Linux, `COM3` –Ω–∞ Windows)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–æ—Ä—Ç—É

#### 2. –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ—Ç ESP32:
```
–î–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–ª—É—á–µ–Ω—ã. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Ü–∏–∫–ª.
```
**–†–µ—à–µ–Ω–∏–µ**: 
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö ESP32
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ ESP32 –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏ (baudrate=115200)

#### 3. –ú–Ω–æ–≥–æ —à—É–º–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤:
```
–®—É–º/–ø–æ—Ç–µ—Ä–∏: 856
```
**–†–µ—à–µ–Ω–∏–µ**: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ—Ä–æ–≥–∏ RSSI –≤ `location_thresholds`

#### 4. –û—à–∏–±–∫–∏ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:
```
–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö: ...
```
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –∏ –∫–æ–¥–∏—Ä–æ–≤–∫—É

## üìä –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ü—Ä–æ—Ü–µ–Ω—Ç—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:
- **Front (–ü–µ—Ä–µ–¥–Ω—è—è)**: 0-30% - –º–∞–ª–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ –ø–µ—Ä–µ–¥–Ω–µ–π —á–∞—Å—Ç–∏
- **Middle (–°—Ä–µ–¥–Ω—è—è)**: 30-60% - —Å—Ä–µ–¥–Ω–µ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ  
- **Back (–ó–∞–¥–Ω—è—è)**: 60-100% - –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ –∑–∞–¥–Ω–µ–π —á–∞—Å—Ç–∏

### –ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö:
- **–í–∞–ª–∏–¥–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã**: RSSI –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ -85 –¥–æ -50 dBm
- **–®—É–º**: RSSI < -85 dBm (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è –≤ –∞–Ω–∞–ª–∏–∑–µ)
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –º–∏–Ω–∏–º—É–º 50-100 –≤–∞–ª–∏–¥–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –¥–ª—è –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞

### –ü—Ä–µ–æ–±–ª–∞–¥–∞—é—â–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:
- **–ó–∞–¥–Ω—è—è —á–∞—Å—Ç—å –¥–æ–º–∏–Ω–∏—Ä—É–µ—Ç**: >60% —Å–∏–≥–Ω–∞–ª–æ–≤ –≤ Back –∑–æ–Ω–µ
- **–ü–µ—Ä–µ–¥–Ω—è—è —á–∞—Å—Ç—å –¥–æ–º–∏–Ω–∏—Ä—É–µ—Ç**: >60% —Å–∏–≥–Ω–∞–ª–æ–≤ –≤ Front –∑–æ–Ω–µ  
- **–°–º–µ—à–∞–Ω–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ**: —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ–∂–¥—É –∑–æ–Ω–∞–º–∏

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
–ë—ã–ª–æ –ø–æ–ª—É—á–µ–Ω–æ —Å–ª–µ–¥—É—é—â–µ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:
![—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã](people_in_the_bus.png)
–î–ª—è –∞–≤—Ç–æ–±—É—Å–∞:
![–∞–≤—Ç–æ–±—É—Å](photo_2025-10-05_11-02-48.jpg)
## üîÆ –î–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ

### –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
- **–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ** –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- **–ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å GPS** –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –æ—Å—Ç–∞–Ω–æ–≤–∫–∞–º
- **–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑** —Ç—Ä–µ–Ω–¥–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
- **–ú—É–ª—å—Ç–∏-ESP32 —Å–∏—Å—Ç–µ–º–∞** –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ –ø–æ–∫—Ä—ã—Ç–∏—è
- **–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** –¥–ª—è –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–æ—Ä–æ–≥–∏** RSSI –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ–º–µ—Ö** –æ—Ç —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö WiFi —Ç–æ—á–µ–∫ –¥–æ—Å—Ç—É–ø–∞
- **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤** –ø–æ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–º –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º
- **–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ** –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤

---

**üöÄ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! –î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã –ø–æ–¥–∫–ª—é—á–∏—Ç–µ ESP32 –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ `python pars_vis.py`**